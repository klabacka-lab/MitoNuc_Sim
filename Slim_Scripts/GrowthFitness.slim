initialize() {
	//parameter to toggle asexual reproduction
	defineConstant("asexual", F);
	defineConstant("popSize", 100);

	//Mutations: expeiment with DFE (manual section 26.11)

	//neutral mutation
	initializeMutationType("m1", 0.1, "f", 0.1);
	//deleterious mutation
	//probably create more?
	//specifically for the preloading
	initializeMutationType("m2", 1.0, "f", -0.5);

	//genomic elements
	initializeGenomicElementType("g1",m1 , 1.0);
	//remove m2?
	initializeGenomicElementType("g2", m1, 1.0);
	initializeGenomicElementType("g3",m1 , 1.0);


	//chromosome 1: mitochondrial chromosome
	initializeChromosome(1, type="H");
	initializeGenomicElement(g1, 0, 1e4-1);
	initializeMutationRate(1e-7);
	initializeRecombinationRate(1e-7);

	//chromosome 2: autosome
	initializeChromosome(2, type="A");
	initializeGenomicElement(g2, 0, 1e5-1);
	initializeMutationRate(1e-7);
	initializeRecombinationRate(1e-7);

	//chromosome 3: autosome
	initializeChromosome(3, type="A");
	initializeGenomicElement(g3, 0, 1e5-1);
	initializeMutationRate(1e-7);
	initializeRecombinationRate(1e-7);
}
1 early() {
	
	//initialize population
	sim.addSubpop("p1", popSize);
	if (asexual == T){
		p1.setCloningRate(1.0);
	}

	//gather mitochondrial chromosomes
	mito_chroms = c();
	for (some in p1.individuals.haplosomes){
		if (some.chromosome.id == 1){
			mito_chroms = c(mito_chroms, some);
		}
	}
	//seed deleterious mutations into 400 mitochondrial chromosomes
	sample(mito_chroms, asInteger(0.95 * popSize)).addNewDrawnMutation(m2, rdunif(1,0,1e4-1));

	g2.setMutationFractions(m2, 0.000000000000001);
}

2 early() {
	print("Mean fitness at generation 1:");
	print(mean(p1.cachedFitness(NULL)));
}

2:999 early() {
	if (mean(p1.cachedFitness(NULL)) >= 1.0){
		//Send a meessage when threshold is reached
		print("Mean fitness at generation " + sim.cycle + " has reached 1.0");
		print("Mean fitness at generation " + sim.cycle + ":");
		print(mean(p1.cachedFitness(NULL)));

		if (asexual == T){
			writeFile(getwd() + "/asexual.txt", asString(sim.cycle), append=T);
		} else {
			writeFile(getwd() + "/sexual.txt", asString(sim.cycle), append=T);
		}

		//deregister this script block to stop this check print
		community.deregisterScriptBlock(self);
	}}

1000 late() { 
	//sim.simulationFinished(); 
	//sim.outputFull();
}

1001 early() { 
	print("Mean fitness at generation 1000:");
	print(mean(p1.cachedFitness(NULL)));
}
